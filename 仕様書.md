# 税金・社会保険計算アプリ（TaxCheck）仕様書

## 1. プロジェクト概要

### 1.1 目的
学生アルバイト・パート従業員が年収に基づく税金（所得税・住民税）と社会保険の負担を簡単に計算し、「収入の壁」を超えないよう収入管理をサポートするWebアプリケーション。学生が気になる「103万円の壁」「106万円の壁」「130万円の壁」などを一目で確認でき、どのラインを超えると何が起こるかを即座に把握できる。

### 1.2 対象ユーザー
- 学生アルバイト
- パート従業員
- 扶養控除を受けている勤労者

---

## 2. 機能要件

### 2.1 主要機能

#### 2.1.1 税金・社会保険自動計算機能
- **入力項目**
  - 年齢（数値）
  - 年収（数値、円単位）
  - 月収（数値、円単位）※社会保険加入判定用
  - 学生区分（はい/いいえ）
  - 扶養区分（親の扶養に入っている/配偶者の扶養に入っている/なし）
  - 勤務先の従業員数（50人以下/51〜100人/101人以上）※社会保険加入判定用
  - 週の勤務時間（数値）※社会保険加入判定用

- **計算内容**
  - 所得税の算出
  - 住民税の算出
  - 社会保険料の算出（健康保険・厚生年金）
  - 社会保険加入要件の判定（106万円の壁/130万円の壁）
  - 手取り額の算出

- **控除の適用**
  - 基礎控除: 48万円
  - 勤労学生控除: 27万円（学生の場合）

#### 2.1.2 非課税枠計算機能
- **入力項目**
  - 現在の日付
  - 現在までの累計収入
  - 目標収入ライン（103万円／130万円／150万円から選択）

- **計算内容**
  - あと何円稼げるか（目標ラインまでの残額）
  - 年末までの残日数
  - 1日あたりの平均収入目安
  - 1ヶ月あたりの平均収入目安

#### 2.1.3 月別収入管理機能
- **入力項目**
  - 各月の収入額（1月〜12月）

- **計算内容**
  - 年間累計収入の自動算出
  - 月別推移の表示

#### 2.1.4 視覚化機能
- **グラフ表示**
  - 月別収入推移グラフ（棒グラフ）
  - 税金発生ラインの表示（103万円／130万円／150万円）
  - 危険ゾーンの色分け表示
    - 緑: 安全圏（〜103万円）
    - 黄: 注意圏（103万円〜130万円）
    - 赤: 課税圏（130万円超）

- **進捗バー**
  - 現在の収入が目標ラインに対して何%か表示

#### 2.1.5 「収入の壁」情報表示機能（5本柱）
- **表示内容**
  - 主要な収入の壁を一覧表示
    - 103万円の壁（所得税）
    - 106万円の壁（社会保険加入）
    - 130万円の壁（扶養・社会保険）
    - 150万円の壁（配偶者控除）
    - 201万円の壁（住民税）

  - 各壁の詳細情報
    - 壁を超えるとどうなるか
    - 具体的な負担額の目安
    - 手取り額への影響
    - 親・配偶者への影響

  - 現在の収入でどの壁に近いかを視覚的に表示
  - 次の壁まであといくらかを表示
  - 「壁を超えた場合」のシミュレーション機能

#### 2.1.6 社会保険加入判定機能
- **判定内容**
  - 106万円の壁（大企業の場合）
    - 週の所定労働時間が20時間以上
    - 月額賃金が88,000円以上
    - 2ヶ月を超える雇用見込み
    - 学生でない（夜間・通信制を除く）
    - 従業員数101人以上の企業（2024年10月〜）

  - 130万円の壁（すべての企業）
    - 年収130万円以上で扶養から外れる
    - 自分で社会保険に加入する必要がある

  - **表示内容**
    - 加入義務の有無
    - 加入条件の詳細説明
    - 社会保険料の試算額

---

## 3. 税金計算ロジック

### 3.1 所得税計算式

```
課税所得 = 年収 - 基礎控除(48万円) - 勤労学生控除(27万円)
```

**税率テーブル**
| 課税所得 | 税率 | 控除額 |
|---------|------|--------|
| 〜100万円 | 5% | 0円 |
| 100万円〜195万円 | 10% | 97,500円 |
| 195万円超 | 20% | 427,500円 |

### 3.2 住民税計算式（簡易版）

```
住民税 = (年収 - 基礎控除(43万円)) × 10%
※ 年収100万円以下は非課税
```

### 3.3 社会保険料計算式

```
【106万円の壁での社会保険料（概算）】
健康保険料 = 月収 × 10% （労使折半で本人負担は5%）
厚生年金保険料 = 月収 × 18.3% （労使折半で本人負担は9.15%）
合計本人負担 = 月収 × 14.15% 程度

【具体例】月収10万円の場合
健康保険料: 5,000円
厚生年金保険料: 9,150円
合計: 約14,150円/月（年間約17万円）
```

### 3.4 主要な収入ライン（収入の壁）5本柱

| ライン | 分類 | 何が起こるか | 影響 |
|--------|------|------------|------|
| **103万円** | 所得税 | 基礎控除48万円＋給与所得控除55万円を超え、所得税が発生 | 本人に所得税が発生（源泉徴収） |
| **106万円** | 社会保険 | 大企業（従業員101人以上）で週20時間以上勤務＋月収8.8万円以上で社会保険加入義務 | 本人に年間約15〜17万円の社会保険料負担（学生除外特例あり） |
| **130万円** | 扶養・社会保険 | 親の社会保険の扶養から外れる | 親の健康保険料が上がる＋本人が国民健康保険・年金に加入必要 |
| **150万円** | 配偶者控除 | 親が配偶者控除を受けている場合、控除が減少 | 親の税負担が増加（配偶者特別控除の減額） |
| **201万円** | 住民税 | 住民税の均等割＋所得割が発生（市区町村により非課税基準100～204万円） | 本人に住民税が発生 |

### 3.4.1 典型的な境界早見表

| 年収 | 主な影響 | 詳細 |
|------|---------|------|
| 〜103万円 | 所得税なし | 扶養OK |
| 103〜106万円 | 所得税あり | 社保は条件次第 |
| 106〜130万円 | 所得税あり | 学生除外なら社保なし |
| 130〜150万円 | 扶養喪失リスク | 親の負担増 |
| 150〜201万円 | 所得税＋住民税発生 | 完全自立ゾーン |

### 3.5 106万円の壁・加入条件詳細

以下のすべてを満たす場合、社会保険加入義務が発生：
1. 週の所定労働時間が20時間以上
2. 月額賃金が88,000円以上（年収106万円）
3. 2ヶ月を超える雇用見込みがある
4. 学生でない（夜間・通信制・定時制を除く）
5. 従業員数101人以上の企業（2024年10月〜）
   ※2022年10月〜2024年9月は501人以上
   ※2026年10月〜は51人以上に拡大予定

---

## 4. 技術構成

### 4.1 フロントエンド
- **フレームワーク**: React + Next.js（推奨）または Streamlit
- **UI ライブラリ**: Tailwind CSS または Material-UI
- **日付処理**: dayjs
- **グラフライブラリ**: Chart.js または Recharts

### 4.2 バックエンド
- **言語**: Python（計算ロジック）
- **計算ロジック**: 税率テーブルと壁判定ロジックを関数化
- **API**: FastAPI または Flask（フロントエンドとの連携）

### 4.3 データ保存
- **ローカル版**: localStorage（ブラウザ保存）
- **拡張版**: Firebase（クラウド保存・複数デバイス同期）

### 4.4 ホスティング
- **候補**: Vercel（Next.js）、Streamlit Cloud、GitHub Pages

---

## 5. 画面構成

### 5.1 ホーム画面
- **表示内容**
  - アプリタイトル「TaxCheck - 収入の壁チェッカー」
  - キャッチコピー「学生バイトの税金・社会保険が一目でわかる！」
  - 基本情報入力フォーム
    - 年齢入力
    - 学生区分選択（チェックボックス）
    - 扶養区分選択（親の扶養/配偶者の扶養/なし）
    - 勤務先の従業員数（50人以下/51〜100人/101人以上）
    - 週の勤務時間（数値入力）
  - クイックアクセスボタン
    - 「収入の壁について知る」→ 5.4へ
    - 「計算を始める」→ 5.2へ

### 5.2 収入入力画面
- **表示内容**
  - 月別収入入力フォーム（1月〜12月）
  - 各月の入力欄（数値のみ）
  - 累計収入の自動表示
  - リアルタイム壁警告
    - 「あと○○円で100万円の壁です」
    - 「103万円を超えています！」など
  - 「計算する」ボタン

### 5.3 結果画面
- **表示内容**
  - 【総合サマリー】
    - 総収入額
    - 所得税額
    - 住民税額
    - 社会保険料（該当する場合）
    - 手取り額（大きく表示）

  - 【社会保険加入判定】
    - 加入義務の有無
    - 加入条件チェックリスト
    - 月額保険料の試算

  - 【あなたが超えた壁】
    - 超えた壁をバッジ表示
    - それぞれの影響額を明示
    - 親・配偶者への影響も表示

  - 【次の壁まで】
    - 次の壁の種類と金額
    - あといくらで到達するか
    - 壁を超えた場合のシミュレーション

  - 【グラフ表示】
    - 月別収入推移グラフ
    - すべての壁をライン表示（103万/106万/130万/150万/201万）
    - ゾーン色分け（緑→黄→オレンジ→赤→紫）
    - 壁レベルごとに色分け表示

  - 【アドバイス】
    - 現在の状況に応じたアドバイス文
    - 「このまま働いても大丈夫」
    - 「あと○万円で社会保険加入になります」など

  - アクションボタン
    - 「データを保存」
    - 「最初から入力」
    - 「PDF出力」（拡張機能）

### 5.4 「収入の壁」情報画面（5本柱）
- **表示内容**
  - 【壁一覧カード】
    - 各壁（103万/106万/130万/150万/201万）をカード形式で表示
    - カードごとに以下を記載：
      - 壁の金額とレベル（レベル1〜5）
      - 何が起こるか
      - 誰に影響があるか（本人/親/配偶者）
      - 具体的な負担額の目安
      - 注意点・条件（106万円の壁の5条件など）

  - 【壁の比較表】
    - すべての壁を一覧で比較できる表（早見表）
    - 収入額別の手取りシミュレーション
    - 壁レベルごとの色分け表示

  - 【よくある質問】
    - Q: 掛け持ちバイトの場合はどうなる？
    - Q: 交通費は年収に含まれる？
    - Q: 夜間学生は106万円の壁の対象外？
    - など

  - 戻るボタン → ホーム画面へ

---

## 6. ユーザーフロー

### 6.1 メインフロー
```
1. ホーム画面で基本情報入力
   ├→ 「収入の壁について知る」→ 壁情報画面へ
   └→ 「計算を始める」
      ↓
2. 収入入力画面で月別収入を入力
   （リアルタイムで壁の警告表示）
   ↓
3. 「計算する」ボタンをクリック
   ↓
4. 結果画面で税額・社会保険料・グラフ・アドバイスを表示
   ├→ データ保存
   ├→ PDF出力
   └→ 最初から入力
```

### 6.2 情報参照フロー
```
ホーム画面
   ↓
「収入の壁について知る」クリック
   ↓
壁情報画面（各壁の詳細・FAQ）
   ↓
「計算してみる」クリック
   ↓
ホーム画面へ戻る
```

---

## 7. データ構造

### 7.1 ユーザー入力データ

```javascript
{
  "userInfo": {
    "age": 20,
    "isStudent": true,
    "dependentType": "parent", // "parent" | "spouse" | "none"
    "companySize": "large", // "small" (50人以下) | "medium" (51-100人) | "large" (101人以上)
    "weeklyHours": 25 // 週の勤務時間
  },
  "monthlyIncome": {
    "1": 80000,
    "2": 85000,
    "3": 90000,
    // ... 12月まで
  },
  "targetLimit": 1030000, // 103万円
  "currentDate": "2025-10-04"
}
```

### 7.2 計算結果データ

```javascript
{
  "totalIncome": 1020000,
  "monthlyAverage": 85000,
  "incomeTax": 5000,
  "residentTax": 59000,
  "socialInsurance": {
    "isRequired": false,
    "type": null, // "106万" | "130万" | null
    "healthInsurance": 0,
    "pensionInsurance": 0,
    "total": 0,
    "conditions": {
      "weeklyHours": true, // 20時間以上か
      "monthlyIncome": false, // 88,000円以上か
      "employmentPeriod": true, // 2ヶ月超か
      "notStudent": false, // 学生でないか（夜間除く）
      "companySize": true // 101人以上か
    }
  },
  "netIncome": 956000,
  "wallsExceeded": [
    {
      "amount": 1000000,
      "name": "100万円の壁（住民税）",
      "impact": "住民税が約1万円発生"
    }
  ],
  "nextWall": {
    "amount": 1030000,
    "name": "103万円の壁（所得税・扶養）",
    "remaining": 10000,
    "impactOnSelf": "所得税が数千円発生",
    "impactOnFamily": "親の税負担が年間5〜16万円増"
  },
  "remainingAllowance": 10000,
  "daysUntilYearEnd": 88,
  "dailyAllowance": 114,
  "monthlyAllowance": 3333,
  "advice": "現在100万円を超えています。103万円の壁まであと1万円です。親の扶養から外れないよう注意しましょう。"
}
```

### 7.3 収入の壁マスターデータ（5本柱）

```python
INCOME_WALLS = [
    {
        "amount": 1030000,
        "name": "103万円の壁",
        "category": "所得税",
        "description": "基礎控除48万円＋給与所得控除55万円を超え、所得税が発生",
        "impacts": {
            "self": "本人に所得税が発生（源泉徴収）",
            "family": None
        },
        "color": "#FFE082",  # 黄色
        "level": 1
    },
    {
        "amount": 1060000,
        "name": "106万円の壁",
        "category": "社会保険",
        "description": "大企業で条件を満たすと社会保険加入義務",
        "conditions": [
            "週20時間以上勤務",
            "月88,000円以上",
            "2ヶ月超雇用",
            "学生でない（学生除外特例あり）",
            "従業員101人以上の企業"
        ],
        "impacts": {
            "self": "社会保険料が年間約15〜17万円発生",
            "family": None
        },
        "color": "#FFAB91",  # オレンジ
        "level": 2
    },
    {
        "amount": 1300000,
        "name": "130万円の壁",
        "category": "扶養・社会保険",
        "description": "親の社会保険の扶養から外れる",
        "impacts": {
            "self": "国民健康保険・年金に加入必要",
            "family": "親の健康保険料が上がる"
        },
        "color": "#EF5350",  # 赤
        "level": 3
    },
    {
        "amount": 1500000,
        "name": "150万円の壁",
        "category": "配偶者控除",
        "description": "配偶者控除を受けている場合、控除が減少",
        "impacts": {
            "self": None,
            "family": "親の税負担が増加（配偶者特別控除の減額）"
        },
        "color": "#C62828",  # 濃い赤
        "level": 4
    },
    {
        "amount": 2010000,
        "name": "201万円の壁",
        "category": "住民税",
        "description": "住民税の均等割＋所得割が発生",
        "impacts": {
            "self": "本人に住民税が発生（市区町村により基準100〜204万円）",
            "family": None
        },
        "color": "#4A148C",  # 紫
        "level": 5
    }
]
```

---

## 8. 非機能要件

### 8.1 パフォーマンス
- 計算結果は1秒以内に表示
- グラフの描画は2秒以内に完了

### 8.2 ユーザビリティ
- スマートフォン対応（レスポンシブデザイン）
- 直感的なUI（入力項目は最小限）
- エラーメッセージは日本語でわかりやすく

### 8.3 セキュリティ
- 個人情報はローカルストレージに保存（サーバー送信なし）
- Firebase使用時はユーザー認証を実装

### 8.4 ブラウザ対応
- Chrome（最新版）
- Safari（最新版）
- Edge（最新版）
- Firefox（最新版）

---

## 9. 開発フェーズ

### Phase 1: MVP（最小機能製品）
- [ ] 基本的な税金計算機能（所得税・住民税）
- [ ] 社会保険加入判定機能（106万円・130万円の壁）
- [ ] シンプルな入力フォーム
- [ ] 結果表示（数値のみ）
- [ ] 「収入の壁」情報画面

### Phase 2: 機能拡張
- [ ] 月別収入入力機能
- [ ] 社会保険料の試算機能
- [ ] リアルタイム壁警告機能
- [ ] グラフ表示機能（すべての壁を表示）
- [ ] 次の壁までの距離表示

### Phase 3: 体験向上
- [ ] 壁を超えた場合のシミュレーション機能
- [ ] 状況別アドバイス表示
- [ ] ローカルストレージでデータ保存
- [ ] レスポンシブデザイン対応
- [ ] アニメーション追加（壁接近時の警告など）

### Phase 4: 拡張機能（オプション）
- [ ] PDF出力機能（計算結果レポート）
- [ ] Firebase連携（データ同期）
- [ ] 複数年データ比較機能
- [ ] プッシュ通知（壁接近アラート）
- [ ] よくある質問（FAQ）の充実化

---

## 10. 注意事項・制約

### 10.1 計算の簡略化について
- このアプリは簡易計算ツールであり、正確な税額・社会保険料の計算には専門家への相談が必要
- 社会保険料率は概算値を使用（地域や保険組合により異なる）
- 各種特別控除（医療費控除等）は考慮しない
- 交通費の扱いは企業により異なるため、収入に含めるかは利用者判断

### 10.2 法改正への対応
- 税制改正時は控除額・税率テーブルを更新する必要あり
- 社会保険の適用拡大スケジュール
  - 2024年10月〜：101人以上の企業
  - 2026年10月〜：51人以上の企業（予定）

### 10.3 学生の特例について
- 夜間学生・通信制学生・定時制学生は106万円の壁の対象外
- 勤労学生控除の適用には別途条件あり

### 10.4 免責事項
- アプリ利用による損害について開発者は責任を負わない旨を明記
- 計算結果はあくまで目安であり、実際の税額・社会保険料は異なる場合がある

---

## 11. 今後の拡張案

### 11.1 機能拡張
- 複数年のデータ管理・比較機能
- 確定申告書類の自動生成補助
- AIによる収入アドバイス機能
- 家族全体の税金・社会保険シミュレーション
- 掛け持ちバイト対応（複数収入源の管理）

### 11.2 情報コンテンツ
- 社会保険の仕組み解説動画
- 税金の仕組み解説（インタラクティブ）
- 実際の手取り額シミュレーター
- ケーススタディ集（学生Aさんの場合など）

### 11.3 ユーザー体験向上
- LINEボットとの連携
- スマホアプリ化（PWA）
- 音声入力対応
- 多言語対応（英語・中国語など）

### 11.4 コミュニティ機能
- 同じ境遇のユーザー同士での情報交換
- 税理士への質問機能
- 最新の法改正情報の自動通知

---

## 12. 重要な学生向けポイント（アプリ内で強調表示）

### 📌 学生が特に注意すべき壁
1. **103万円の壁**：これを超えると親の扶養から外れ、親の税負担が大幅増
2. **106万円の壁**：大企業バイトで条件を満たすと社会保険加入（年間約15万円の負担）
3. **130万円の壁**：どんな企業でも扶養から外れる

### 💡 学生の特例
- 夜間・通信・定時制の学生は106万円の壁の対象外
- 勤労学生控除を使えば130万円まで所得税非課税（親の扶養は103万円で外れる）

### ⚠️ よくある誤解
- 「交通費は年収に含まれない」→ 企業により異なる
- 「12月だけ減らせば大丈夫」→ 年間合計で判定
- 「バレなければ大丈夫」→ 年末調整・確定申告で必ず発覚

---

**作成日**: 2025年10月4日
**最終更新日**: 2025年10月4日
**バージョン**: 2.0（社会保険対応版）
